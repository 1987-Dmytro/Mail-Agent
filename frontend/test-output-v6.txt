
> frontend@0.1.0 test:e2e:chromium
> playwright test --project=chromium tests/e2e/complete-user-journey.spec.ts


Running 2 tests using 2 workers

âœ… MSWâ†’Playwright Bridge: Installed 12/12 routes
=== TESTING RETURNING USER EXPERIENCE ===
âœ… MSWâ†’Playwright Bridge: Installed 12/12 routes
=== STARTING COMPLETE USER JOURNEY E2E TEST ===

ğŸ”§ PHASE 0: Setting up auth tokens to simulate connected services
ğŸ”µ PW Route: Intercepted GET http://localhost:8000/api/v1/auth/status
ğŸ”µ PW Route: Returning user: {
  "id": 1,
  "email": "test@example.com",
  "gmail_connected": true,
  "telegram_connected": true,
  "telegram_id": "123456789",
  "telegram_username": "testuser",
  "onboarding_completed": true
}

ğŸ“‹ PHASE 1: Onboarding - Welcome
ğŸ”µ PW Route: Intercepted GET http://localhost:8000/api/v1/auth/status
ğŸ”µ PW Route: Returning user: {
  "id": 1,
  "email": "test@example.com",
  "gmail_connected": true,
  "telegram_connected": true,
  "telegram_id": "123456789",
  "telegram_username": "testuser",
  "onboarding_completed": true
}
ğŸ”µ PW Route: Intercepted GET http://localhost:8000/api/v1/auth/status
ğŸ”µ PW Route: Returning user: {
  "id": 1,
  "email": "test@example.com",
  "gmail_connected": true,
  "telegram_connected": true,
  "telegram_id": "123456789",
  "telegram_username": "testuser",
  "onboarding_completed": true
}
ğŸ”µ MSW: Intercepted GET http://localhost:8000/api/v1/auth/gmail/config
ğŸ”µ MSWâ†’PW: GET /api/v1/auth/gmail/config â†’ 200
ğŸ”µ MSW: Intercepted GET http://localhost:8000/api/v1/dashboard/stats
ğŸ”µ MSW: Intercepted GET http://localhost:8000/api/v1/auth/gmail/config
ğŸ”µ MSWâ†’PW: GET /api/v1/auth/gmail/config â†’ 200
ğŸ”µ MSWâ†’PW: GET /api/v1/dashboard/stats â†’ 200

ğŸ“§ PHASE 2: Gmail Connection - verifying token detection
âœ… RETURNING USER TEST PASSED
  âœ“  2 [chromium] â€º tests/e2e/complete-user-journey.spec.ts:180:7 â€º Complete User Journey E2E â€º returning user can access all features directly (1.4s)

ğŸ’¬ PHASE 3: Telegram Linking - verifying token detection
ğŸ”µ MSW: Intercepted POST http://localhost:8000/api/v1/telegram/link
ğŸ”µ MSWâ†’PW: POST /api/v1/telegram/link â†’ 200
ğŸ”µ MSW: Intercepted GET http://localhost:8000/api/v1/telegram/verify/123456 (code: 123456)
ğŸ”µ MSWâ†’PW: GET /api/v1/telegram/verify/123456 â†’ 200
Telegram detected token and showed success state - clicking Continue

ğŸ“ PHASE 4: Folder Setup - creating default folder
  âœ˜  1 [chromium] â€º tests/e2e/complete-user-journey.spec.ts:26:7 â€º Complete User Journey E2E â€º new user completes full onboarding and uses the system (5.6s)


  1) [chromium] â€º tests/e2e/complete-user-journey.spec.ts:26:7 â€º Complete User Journey E2E â€º new user completes full onboarding and uses the system 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator: getByRole('heading', { name: /setup folders|folder/i })
    Expected: visible
    Error: strict mode violation: getByRole('heading', { name: /setup folders|folder/i }) resolved to 2 elements:
        1) <h2 class="text-xl font-semibold text-foreground">Setup Folders</h2> aka getByRole('heading', { name: 'Setup Folders' })
        2) <h2 class="text-2xl font-bold">Setup Your Folders</h2> aka getByRole('heading', { name: 'Setup Your Folders' })

    Call log:
    [2m  - Expect "toBeVisible" with timeout 5000ms[22m
    [2m  - waiting for getByRole('heading', { name: /setup folders|folder/i })[22m


      117 |
      118 |     // Wait for folder setup step
    > 119 |     await expect(page.getByRole('heading', { name: /setup folders|folder/i })).toBeVisible({ timeout: 5000 });
          |                                                                                ^
      120 |
      121 |     // Create at least one folder (required for validation)
      122 |     const folderNameInput = page.getByPlaceholder(/folder name|category name/i);
        at /Users/hdv_1987/Desktop/ĞŸÑ€Ñ€Ğ¾ĞµĞºÑ‚Ñ‹/Mail Agent/frontend/tests/e2e/complete-user-journey.spec.ts:119:80

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/complete-user-journey-Comp-71358-oarding-and-uses-the-system-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/complete-user-journey-Comp-71358-oarding-and-uses-the-system-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/complete-user-journey-Comp-71358-oarding-and-uses-the-system-chromium/error-context.md

  1 failed
    [chromium] â€º tests/e2e/complete-user-journey.spec.ts:26:7 â€º Complete User Journey E2E â€º new user completes full onboarding and uses the system 
  1 passed (10.0s)

[36m  Serving HTML report at http://localhost:56384. Press Ctrl+C to quit.[39m
