
> frontend@0.1.0 test:e2e:chromium
> playwright test --project=chromium tests/e2e/complete-user-journey.spec.ts


Running 2 tests using 2 workers

âœ… MSWâ†’Playwright Bridge: Installed 13/13 routes
=== STARTING COMPLETE USER JOURNEY E2E TEST ===
âœ… MSWâ†’Playwright Bridge: Installed 13/13 routes
=== TESTING RETURNING USER EXPERIENCE ===

ðŸ”§ PHASE 0: Setting up auth tokens to simulate connected services

ðŸ“‹ PHASE 1: Onboarding - Welcome
ðŸ”µ MSW: Intercepted GET http://localhost:8000/api/v1/auth/gmail/config
ðŸ”µ MSWâ†’PW: GET /api/v1/auth/gmail/config â†’ 200
ðŸ”µ MSW: Intercepted GET http://localhost:8000/api/v1/auth/gmail/config
ðŸ”µ MSWâ†’PW: GET /api/v1/auth/gmail/config â†’ 200

ðŸ“§ PHASE 2: Gmail Connection - verifying token detection
ðŸ”µ PW Route: Intercepted GET http://localhost:8000/api/v1/auth/status
ðŸ”µ PW Route: Returning user: {
  "id": 1,
  "email": "test@example.com",
  "gmail_connected": true,
  "telegram_connected": true,
  "telegram_id": "123456789",
  "telegram_username": "testuser",
  "onboarding_completed": true
}
ðŸ”µ PW Route: Intercepted GET http://localhost:8000/api/v1/auth/status
ðŸ”µ PW Route: Returning user: {
  "id": 1,
  "email": "test@example.com",
  "gmail_connected": true,
  "telegram_connected": true,
  "telegram_id": "123456789",
  "telegram_username": "testuser",
  "onboarding_completed": true
}
ðŸ”µ MSW: Intercepted GET http://localhost:8000/api/v1/dashboard/stats
ðŸ”µ MSWâ†’PW: GET /api/v1/dashboard/stats â†’ 200
âœ… RETURNING USER TEST PASSED
  âœ“  1 [chromium] â€º tests/e2e/complete-user-journey.spec.ts:175:7 â€º Complete User Journey E2E â€º returning user can access all features directly (1.5s)

ðŸ’¬ PHASE 3: Telegram Linking - verifying token detection
ðŸ”µ MSW: Intercepted POST http://localhost:8000/api/v1/telegram/link
ðŸ”µ MSWâ†’PW: POST /api/v1/telegram/link â†’ 200
ðŸ”µ MSW: Intercepted GET http://localhost:8000/api/v1/telegram/verify/123456 (code: 123456)
ðŸ”µ MSWâ†’PW: GET /api/v1/telegram/verify/123456 â†’ 200
Telegram detected token and showed success state - clicking Continue

ðŸ“ PHASE 4: Folder Setup - creating default folder
ðŸ”µ MSW: Intercepted POST http://localhost:8000/api/v1/folders {
  name: [32m'Important'[39m,
  keywords: [ [32m'urgent'[39m, [32m'Ð²Ð°Ð¶Ð½Ð¾'[39m, [32m'wichtig'[39m ],
  color: [32m'#EF4444'[39m
}
ðŸ”µ MSWâ†’PW: POST /api/v1/folders â†’ 200
ðŸ”µ MSW: Intercepted POST http://localhost:8000/api/v1/folders {
  name: [32m'Government'[39m,
  keywords: [ [32m'finanzamt'[39m, [32m'auslÃ¤nderbehÃ¶rde'[39m, [32m'tax'[39m, [32m'visa'[39m ],
  color: [32m'#F97316'[39m
}
ðŸ”µ MSWâ†’PW: POST /api/v1/folders â†’ 200
ðŸ”µ MSW: Intercepted POST http://localhost:8000/api/v1/folders {
  name: [32m'Clients'[39m,
  keywords: [ [32m'meeting'[39m, [32m'project'[39m, [32m'client'[39m ],
  color: [32m'#3B82F6'[39m
}
ðŸ”µ MSWâ†’PW: POST /api/v1/folders â†’ 200

âœ… PHASE 5: Completion Step
ðŸ”µ MSW: Intercepted POST http://localhost:8000/api/v1/users/complete-onboarding
ðŸ”µ MSWâ†’PW: POST /api/v1/users/complete-onboarding â†’ 200

ðŸ“Š PHASE 6: Verifying Dashboard
Current URL: http://localhost:3000/onboarding
  âœ˜  2 [chromium] â€º tests/e2e/complete-user-journey.spec.ts:26:7 â€º Complete User Journey E2E â€º new user completes full onboarding and uses the system (20.0s)


  1) [chromium] â€º tests/e2e/complete-user-journey.spec.ts:26:7 â€º Complete User Journey E2E â€º new user completes full onboarding and uses the system 

    Error: [2mexpect([22m[31mpage[39m[2m).[22mtoHaveURL[2m([22m[32mexpected[39m[2m)[22m failed

    Expected pattern: [32m/\/dashboard/[39m
    Received string:  [31m"http://localhost:3000/onboarding"[39m
    Timeout: 10000ms

    Call log:
    [2m  - Expect "toHaveURL" with timeout 10000ms[22m
    [2m    14 Ã— unexpected value "http://localhost:3000/onboarding"[22m


      159 |     // CRITICAL: Verify we reached the DASHBOARD page (not just completion message)
      160 |     // This is what the user specifically requested - see dashboard in screenshot
    > 161 |     await expect(page).toHaveURL(/\/dashboard/, { timeout: 10000 });
          |                        ^
      162 |
      163 |     // Verify dashboard content loads
      164 |     const dashboardHeading = page.getByRole('heading', { name: /dashboard|overview/i });
        at /Users/hdv_1987/Desktop/ÐŸÑ€Ñ€Ð¾ÐµÐºÑ‚Ñ‹/Mail Agent/frontend/tests/e2e/complete-user-journey.spec.ts:161:24

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/complete-user-journey-Comp-71358-oarding-and-uses-the-system-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/complete-user-journey-Comp-71358-oarding-and-uses-the-system-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/complete-user-journey-Comp-71358-oarding-and-uses-the-system-chromium/error-context.md

  1 failed
    [chromium] â€º tests/e2e/complete-user-journey.spec.ts:26:7 â€º Complete User Journey E2E â€º new user completes full onboarding and uses the system 
  1 passed (24.6s)

[36m  Serving HTML report at http://localhost:9323. Press Ctrl+C to quit.[39m
